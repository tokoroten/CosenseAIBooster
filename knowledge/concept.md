# CosenseAIBoosterの仕様

対象となるサービスは cosense、旧 Scrapbox
https://scrapbox.io/
https://cosen.se/

## 以下の機能を作成する

### 設定画面
- 右側のアイコン欄の下に、歯車マークがあり、クリックすると設定画面が開く
- 設定画面は、Chromeの拡張機能の設定画面を利用する
- 設定画面では、以下の項目を設定できる
  - プロンプトの編集・追加
  - プロンプトの適用方法
    - 選択範囲の下に挿入するか、ページの最下部に挿入するかを選択できる
    - どのモデルを適用するのかを選択することができる
  - 音声入力の言語設定
    - 音声入力で使用する言語を選択できる
  - OpenAIのAPIキーの設定
    - OpenAIのAPIキーを入力することで、プロンプトの実行にOpenAIのAPIを利用できるようになる
    - OpenAIのAPIキーは、Extension側に保存されるようにする
    - OpenRouterのAPIキーを設定することを可能にし、無料枠でも利用できるようにする
      - OpenAIの互換APIの利用を可能にするため、エンドポイントの設定も可能にする
      - 可能であればLocalLLMへの接続も可能にする

### UI拡張
- Cosenseのページメニュー（右側のボタン群）に新しいUI要素を追加するためのユーティリティクラスを実装する
  - `CosenseMenuManager` クラスを用いて、ドロップダウンメニューや単独ボタンを追加できる
  - 既存UIと同じスタイルで統一感のあるUIを提供する
  - カスタムアイコンや機能を追加するための柔軟な仕組みを提供する

### 音声入力
- 右側のアイコン欄の下に、マイクマークがあり、マイクマークをクリックすると音声入力モードになる
- 音声入力は、WebSpeechAPIのSpeechRecognitionを利用して実装する
- 音声入力モードは、生のテキストがいったん入力され、入力がひと段落すると、自動的にプロンプトが適用され、成形される
  - どのプロンプトを使うのかは予め選択することができる

### プロンプトの適用
- ページ内の文章を選択すると、「プロンプトAを適用」といったメニューが表示される
  - ページ内の特定の文章に対してプロンプトを適用し、結果を選択範囲の下、もしくは文章の最下部に挿入することができる
  - プロンプトに対する細かい挙動はExtensionの設定メニューから変更できる

## 開発方針
- node 18で開発する
- TypeScript、React、JSX、Tailwind、Zustandで開発する
- ViteとWXTを使用して開発する
- ESLintとPrettierを使用してコードを整形する
- Chrome拡張機能のマニフェストバージョンは3を使用する
- デザインは、Cosenseのデザインに合わせる
- Cosenseのページ上で動作することを前提とする
- Cosenseのページ上で動作するため、コンテンツスクリプトを使用してDOM操作を行う

